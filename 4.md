<table><tbody><tr><td style="background-color: rgb(219, 238, 221);"><p><strong><span style="color: rgb(25, 60, 71)"><span style="background-color: rgb(219, 238, 221)">Author:</span></span></strong><span style="color: rgb(25, 60, 71)"><span style="background-color: rgb(219, 238, 221)"> ;</span></span></p></td></tr><tr><td style="background-color: rgb(243, 250, 244);"><p><strong><span style="color: rgb(25, 60, 71)"><span style="background-color: rgb(243, 250, 244)">Journal: (Publication Date: )</span></span></strong></p></td></tr><tr><td style="background-color: rgb(219, 238, 221);"><p><strong><span style="color: rgb(25, 60, 71)"><span style="background-color: rgb(219, 238, 221)">Journal Tags:</span></span></strong></p></td></tr><tr><td style="background-color: rgb(243, 250, 244);"><p><strong><span style="color: rgb(25, 60, 71)"><span style="background-color: rgb(243, 250, 244)">Local Link:</span></span></strong></p></td></tr><tr><td style="background-color: rgb(219, 238, 221);"><p><strong><span style="color: rgb(25, 60, 71)"><span style="background-color: rgb(219, 238, 221)">URL:</span></span></strong></p></td></tr><tr><td style="background-color: rgb(243, 250, 244);"><p><strong><span style="color: rgb(25, 60, 71)"><span style="background-color: rgb(243, 250, 244)">Abstract:</span></span></strong></p></td></tr><tr><td style="background-color: rgb(219, 238, 221);"><p><strong><span style="color: rgb(25, 60, 71)"><span style="background-color: rgb(219, 238, 221)">Note Date: </span></span></strong><span style="color: rgb(25, 60, 71)"><span style="background-color: rgb(219, 238, 221)">2024/8/16 08:19:25</span></span></p></td></tr></tbody></table>

## 📜 Research Core

* * *

> Tips: What was done, what problem was solved, innovations and shortcomings?

### ⚙️ Content

LLM-guided Protocol Fuzzing 是一种新颖的协议模糊测试方法，利用预训练的大型语言模型（LLMs）来指导协议实现的模糊测试。该方法通过从LLM中提取机器可读的协议信息，生成结构化的消息类型并增强种子消息的多样性，从而提高了状态和代码的覆盖率。实验结果表明，该工具在多个真实世界的协议中显著提高了状态和代码的覆盖率，并发现了多个此前未知的漏洞。

### 💡 Innovations

1. **LLM驱动的协议模糊测试**：首次引入了利用LLMs来生成协议实现中的消息结构信息，以指导协议模糊测试的创新方法。
2. **多样化种子消息生成**：提出了一种通过与LLM交互来增强初始种子消息多样性的策略，从而覆盖更多协议状态。
3. **突破覆盖瓶颈的机制**：开发了在模糊测试中突破覆盖瓶颈的机制，利用LLM生成能够触发新状态的消息。
   
    “We call this approach LLM-guided protocol fuzzing and” ([Meng 等, 2024, p. 1](zotero://select/library/items/GWLHPMUM)) ([pdf](zotero://open-pdf/library/items/25NCKAX9?page=1))
    
    “Secondly, the fuzzer uses the LLM to increase the diversity of messages in the recorded message sequences that are used as initial seeds. Lastly, the fuzzer uses the LLM to break out of a coverage plateau, wher” ([Meng 等, 2024, p. 2](zotero://select/library/items/GWLHPMUM)) ([pdf](zotero://open-pdf/library/items/25NCKAX9?page=2))
    

### 🧩 Shortcomings

## 🔁 Research Content

* * *

### 💧 Data

LLM-guided Protocol Fuzzing在多个真实世界的协议（包括RTSP, FTP, SIP, SMTP, DAAP）上进行了实验。这些协议广泛应用于流媒体、消息传递和文件传输等领域。实验使用的基准测试平台是PROFUZZBENCH，评估了该工具相对于AFLNET和NSFUZZ的状态和代码覆盖率。

“presents the subject programs that are used in our evaluation. Our benchmark consists of six text-based network protocol implementations, including five widely-used network protocols (i.e., RTSP, FTP, SIP, SMTP, and DAAP).” ([Meng 等, 2024, p. 9](zotero://select/library/items/GWLHPMUM)) ([pdf](zotero://open-pdf/library/items/25NCKAX9?page=9))

### 👩🏻‍💻 Method

LLM-guided Protocol Fuzzing通过以下三个关键步骤实现其功能：

1. 从LLM中提取协议的语法结构，用于指导消息的结构化变异。
2. 增强初始种子消息的多样性，通过与LLM交互生成缺失的消息类型并插入到种子消息序列中。
3. 在模糊测试过程中，当覆盖陷入瓶颈时，通过LLM生成可能触发新状态的消息，从而突破覆盖瓶颈。

“CHATAFL implements three strategies to interact with the LLM to overcome the challenges of protocol fuzzing: • SA) grammar-guided mutation, • SB) enriching initial seeds, and • SC ) surpassing coverage plateau.” ([Meng 等, 2024, p. 11](zotero://select/library/items/GWLHPMUM)) ([pdf](zotero://open-pdf/library/items/25NCKAX9?page=11))

### 🔬 Experiment

LLM-guided Protocol Fuzzing在六种协议上的实验表明，其状态和代码覆盖率显著高于现有的模糊测试工具AFLNET和NSFUZZ。具体来说，CHATAFL比AFLNET多覆盖了47.60%的状态转换和29.55%的状态，同时代码覆盖率提高了5.81%。此外，CHATAFL发现了九个此前未知的漏洞，而AFLNET和NSFUZZ分别只发现了三个和四个。

“To evaluate the utility of Large Language Models (LLMs) for tackling the challenges of mutation-based protocol fuzzing of text-based network protocols, we seek to answer the following questions: RQ.1 State coverage. How much more state coverage does CHATAFL achieve compared to baseline? RQ.2 Code coverage. How much more code coverage does CHATAFL achieve compared to baseline? RQ.3 Ablation. What is the impact of each component on the performance of CHATAFL? RQ.4 New bugs. Is CHATAFL useful in discovering previously unknown bugs in widely-used and extensively-tested protocol implementations?” ([Meng 等, 2024, p. 9](zotero://select/library/items/GWLHPMUM)) ([pdf](zotero://open-pdf/library/items/25NCKAX9?page=9))

### 📜 Conclusion

研究结果表明，LLM-guided Protocol Fuzzing通过与LLM的交互，可以显著提高协议实现的模糊测试效果，尤其在状态和代码覆盖率方面表现出色。此外，CHATAFL发现了多个之前未知的漏洞，展示了其在实际应用中的强大潜力。

## 🤔 Personal Summary

* * *

> Tips: What aspects did you question, how do you think it can be improved?
> 
> **工作流程**
> 
> 1. **语法引导的变异（Grammar-guided Mutation）**：CHATAFL首先从LLM中提取协议的机器可读语法，这些语法被用于结构感知的消息变异。在变异的过程中，CHATAFL利用这些提取的语法对协议消息进行修改，以生成新的测试输入。
> 2. **种子消息的多样化（Enriching Initial Seeds）**：为了提高模糊测试的覆盖率，CHATAFL会使用LLM来增加初始种子消息的多样性。这是通过向现有的种子消息序列中添加新的消息来实现的，这些消息可能会触发协议的新状态。
> 3. **突破覆盖瓶颈（Surpassing Coverage Plateau）**：当模糊测试进入覆盖瓶颈，即发现新的覆盖率停止增长时，CHATAFL会通过与LLM交互来生成能够突破瓶颈的新消息。这些消息被设计用来探索协议的未见状态或路径。
> 
> “**种子**”指的是模糊测试过程中用作初始输入的协议消息序列。这些种子是模糊测试的起点，通过对这些消息进行变异和组合，可以生成大量的测试用例，从而探索协议实现中的潜在漏洞。

### 4\. 文献处理分析：`Large Language Model guided Protocol Fuzzing`

#### 4.1. 序号 + 文章名称

序号: 7  
文章名称: *Large Language Model guided Protocol Fuzzing*

#### 4.2. 查看是否在GitHub或其他网站存在相应代码

代码存在性: 代码在GitHub上托管。  
代码链接: [GitHub - ChatAFL](https://github.com/ChatAFLndss/ChatAFL)

#### 4.3. 区分对LLM进行Fuzz还是用LLM辅助Fuzz

该文献讨论了使用LLM辅助协议模糊测试，重点在于如何利用LLM生成协议的机器可读语法和扩展初始种子序列。

#### 4.4. 每个fuzz的生成测试样例是什么，对象是什么，和生成策略

- 生成的测试样例: 协议消息序列，包括RTSP、FTP、SIP、SMTP、DAAP等协议的消息请求。
- 测试对象: 多种网络协议实现，包括RTSP (LIVE555)、FTP (ProFTPD, PureFTPD)、SIP (Kamailio)、SMTP (Exim)、DAAP (forked-daapd)。
- 生成策略:
  
    - **语法提取**: 使用LLM从协议规范中提取机器可读的语法结构，指导模糊测试过程中的结构感知变异。
    - **初始种子扩展**: LLM生成新的协议消息类型，增加初始种子的多样性，并将这些消息插入到现有的消息序列中。
    - **覆盖率突破**: 当模糊测试进入覆盖率平台期时，LLM生成可能触发状态转换的新消息，帮助突破覆盖率瓶颈。

#### 4.5. 若是Fuzz for LLM，请注明测试的是LLM哪一部分

该文献未涉及对LLM的fuzzing。

#### 4.6. 若是LLM for Fuzz，请注明LLM在Fuzz中发挥了什么作用

LLM在fuzzing中发挥了关键作用，通过生成协议语法、扩展初始种子序列和帮助突破覆盖率平台期来辅助协议模糊测试。

### 总结

本文提出了一种基于LLM的协议模糊测试方法，利用LLM生成协议的机器可读语法、扩展初始种子序列，并在模糊测试的覆盖率平台期提供新的测试输入，以增强协议实现的测试覆盖率。文中提到的代码托管在GitHub平台上。